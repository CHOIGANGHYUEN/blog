# 스키마 정제와 정규형
## 스키마 정제 개요
- 정제되지 않은 스키마에서 문제
  - 중복 이상
    - 어떤 데이터는 반복적으로 저장
  - 갱신 이상
    - 반복 저장된 데이터 중 한 투플을 갱신할 때 다른 모든 사본을 갱신하지 않으면 불일치
  - 삽입 이상
    - 한 정보를 저장하려면 다른 정보다 같이 저장해야함
  - 삭제 이상
    - 어떤 정보를 지우면 다른 정보도 같이 삭제
- 중복성으로 발생하는 문제
```
스키마가 제대로 정제되지않으면 다양한 문제가 발생

```
- 예시

|EmpId|EmpName|Packingslot|Grade|WagePerHr|Workingtime|
|----|-------|------------|-----|-------|------|
|1|홍길동|16|8|16000|10|
|2|김길동|23|8|16000|20|
|3|고길동|41|8|16000|40|
|4|이길동|44|5|10000|30|
|5|박길동|52|8|16000|50|
- WagePerHr은 Grade속성에 의해 결정하는 무결성 제약조건이 존재한다고 가정
- 하나의 Grade에 해당하는 WagePerHr는 하나밖에 존재하지 않는다고 가정
- 발생할 수 있는 문제
  - 어떤 정보는 여러 번 저장 될 가능성이 존재함. grade에 8이 4번 저장됨에 따라 WagePerHr도 4번 반복된다. 이러한 중복은 잠재적으로 불일치가 발생 할 가능성이 있음
  - 첫 번째 투플의 WagePer 값을 갱신헸디면 두 번째 투플의 값을 갱신하지 않았다면 갱신 이상이 발생
  - 한 직원의 투플을 삽입하려면 직원의 Grade 값에 따른 WagePerHr값을 알아야 함. 잘못된 값을 입력할 경우 삽입 이상이 발생
  - 어떤 등급 값에 대한모든 투플을 삭제한다면 그 등급 값과 그에 따른 WagePerHr의 연관성을 잃어버리게되 삭제이상 발생

```
이해한 것
1. 삽입 이상 : 만약 최강현에 해당하는 투플을 삽입하게 될때 Grade는 8을 입력하고 WagePerHr에는 15000을 입력하게되면 무결성제약조건에 위배되는 삽입 이상이 발생한다. 또한 데이터 일관성이 깨진다.
2. 삭제 이상 : 만약 특정 Grade를 삭제 하려 한다면, 해당 투플 자체가 불안정하게 된다.
3. 어떤 Graded에 해당하는 WagePerHr의 값을 18000으로 수정하려할때 그 Grade에 해당하는 투플중 하나라도 수정하지 않는다면 갱신 이상
```

## 분해법
- 속성을 부자연스럽게 묶어서 한 릴레이션 스키마로 만들면 중복성이 발생
- 함수 종속을 이용해 상황을 식별
  - 릴레이션을 더 작은 릴레이션의 모임으로 대치
  - 작은 릴레이션은 본래 릴레이션 속성의 부분 집합으로 이루어짐
- 분해의 문제
  - 릴레이션의 분해가 필요한가?
    - 제안된 정규형으로 분해
  - 분해 했을때 발생할 문제?
    - 무손실 조인 성질에 띠리 릴레이션 인스턴스 복구
    - 종속성 유지 조건에 따라 계약 조건 유지

[기존]
|EmpId|EmpName|Packingslot|Grade|WagePerHr|Workingtime|
|----|-------|------------|-----|-------|------|
|1|홍길동|16|8|16000|10|
|2|김길동|23|8|16000|20|
|3|고길동|41|8|16000|40|
|4|이길동|44|5|10000|30|
|5|박길동|52|8|16000|50|

[분해후1]

|EmpId|EmpName|Packingslot|Grade|Workingtime|
|----|-------|------------|--------|------|
|1|홍길동|16|8|10|
|2|김길동|23|8|20|
|3|고길동|41|8|40|
|4|이길동|44|5|30|
|5|박길동|52|8|50|

[분해후2]
|Grade|WagePerHr|
|-|-|
|8|16000|
|5|10000|