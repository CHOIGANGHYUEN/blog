# 

# 음식 배달

- 음식을 주문하고 배송하는 Application 개발

## 1 매장관리

### 1.1 매장등록

- 사업자 등록증을 첨부해야 하며, 관리자는 국세청에서 제공하는 '국세청_사업자등록정보 진위확인 및 상태조회 서비스'를 활용하여 확인 후 승인해야 합니다. 즉 사업자로 승인된 사업자 회원만 입점할 수 있습니다.
    - https://www.data.go.kr/data/15081808/openapi.do
- 이름(상호), 주소, 전화번호, 영업시간 등 정보를 등록해야 합니다.
    - 영업시간을 사업장마다 설정할 수 있으며, 영업이 종료되면 사용자는 주문할 수 없습니다.
    - 이름(상호)은 중복될 수 있지만, 고유하게 식별할 수 있어야 합니다.
- 개인 및 가맹점 입점이 되어야 합니다.
    - ex) 가맹점
        - NHN 치킨
            - NHN 치킨 조선대점
            - NHN 치킨 봉선점
            - NHN 치킨 학동점
    - ex) 개인
        - GT커피
        - 카페호시정
        - 카페벨벳
- 가맹점 점주가 가맹점을 등록할 수 있도록 가맹점 목록은 시스템 관리자가 관리합니다.
    - ex) 프렌차이즈 가맹점
        - 교촌치킨
        - 스타벅스
        - 메가커피
- 음식점의 GPS 좌표를 등록합니다. (아래 API를 참고합니다.)
    - 좌표로 주소 얻어내기
        - https://apis.map.kakao.com/web/sample/coord2addr/
    - 다음 지도 API를 함께 활용하여 선택한 주소에 대한 좌표를 가져와서 지도에 표시하는 예제입니다.
        - https://postcode.map.daum.net/guide
- 등록된 GPS 좌표를 기준으로 지도에 위치를 표시합니다.
- 사업자 회원은 n개의 매장을 관리할 수 있습니다.

### 1.2 매장 관리자 인증

- 등록된 아이디, 비밀번호를 이용해서 로그인/로그아웃합니다.

### 1.3 메뉴 등록

- 판매자는 음식점에서 판매하는 메뉴의 정보를 등록해야 합니다.
- 메뉴 이름, 가격, 설명, 이미지, 조리 시간 등을 포함해야 합니다.
    - WYSIWYG(위즈윅) Editor를 사용해서 등록합니다.
        - https://ui.toast.com/tui-editor
        - https://summernote.org/
- 보조 메뉴를 등록할 수 있습니다.
    - ex) 웨지감자, 치킨 무, 양념 소스, 콜라500ml, 콜라1.5l
- 메뉴와 보조 메뉴는 M:N 관계입니다.

### 1.4 실시간 주문관리

- 주문은 다음 상태에 의해서 관리되어야 합니다.
    - 대기: 사용자가 주문한(결제된) 리스트를 확인할 수 있습니다.
    - 조리: 음식을 조리합니다.
    - 배달: 배달시스템에 접수하고 배달 진행 중
    - 완료: 배달이 완료된 상태
- 주문 상태는 필요시 변경할 수 있습니다.
- 주문 접수 알림 서비스를 제공해야 합니다.
    - Dooray에 알림 메시지 전송
    - 매장 관리자에서 알림(소리) 발생
        - ex) '주문이 접수되었습니다.'

### 1.5 매출 관리

- 일 매출 관리: 범위를 지정하여 일 단위 매출 현황을 조회합니다.
    - ex) 2023.05.01~2023.06.20일 단위 매출 현황
    - 해당 기간 판매된 메뉴별 매출 현황이 리스트 형태로 제공되어야 합니다.
        - 정렬 기준
            - 판매된 건수
            - 매출액 합계

## 2 회원

### 2.1 회원가입

- 회원 가입할 수 있는 기능을 제공합니다.
    - 이름, 연락처, 이메일, 주소, 생일 등을 포함해야 합니다.
    - 주소는 최대 10개까지 등록할 수 있으며 별칭을 설정할 할 수 있습니다.
        - ex) 별칭:NHN, 주소 : 경기도 성남시 분당구 대왕판교로 645번 길 16
    - 주소는 도로명주소를 기준으로 등록합니다. (지번 주소 사용금지)

### 2.2 회원인증

- 사용자는 로그인하여 음식 배달 서비스를 이용할 수 있고, 로그아웃하여 종료할 수 있습니다.
- PAYCO 로그인 제공 ( 아래 내용을 참고합니다. )
    - https://developers.payco.com/guide/development/apply/web
    - 애플리케이션 등록
        - https://developers.payco.com/application
        - 웹 서비스 URL, Callback URL은 프로젝트에서 사용할 URL을 등록합니다.
            
            !https://github.com/nhn-academy-marco/nhn-academy-project-delivery/raw/main/01.%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD/images/img_0.png
            
        - 해당 URL을 local에서 테스트하기 위해서는 /etc/hosts에 사용할 URL을 등록합니다.
        
        ```
        vi sudo  /etc/hosts
        127.0.0.1 test.com
        ```
        
- 회원은 개인 정보를 수정할 수 있습니다.

### 2.3 회원 등급

- 전 달구매 금액에 따른 회원 등급이 매월 1일 05:00에 반영되어야 합니다.
- 회원등급은 주문 횟수에 의해서 부여됩니다.
    - 프랜드 : 0~2
        - 1만 원 이상 구매 시 500원 할인 쿠폰 (2장)
    - 패밀리 : 3~5
        - 1만 원 이상 구매 시 1,000원 할인 쿠폰 (2장)
    - 마스터 : 6~10
        - 1만 원 이상 구매 시 5,000원 할인 쿠폰 (2장)
        - 배송료 무료 쿠폰(2장)
    - VIP : 11 이상
        - 1만 원 이상 구매 시 10,000원 할인 쿠폰(2장)
- 회원등급과 혜택은 매달 변경될 수 있습니다.
- 회원등급은 mypage에서 확인할 수 있으며 회원 등급별 혜택이 제공되어야 합니다.

### 2.4 회원 탈퇴

- 회원 탈퇴 시 한 번 등록한 아이디는 다시 사용할 수 없습니다.
- mypage에서 회원 탈퇴할 수 있는 기능이 제공되어야 합니다.
- 회원 탈퇴와 함께 로그아웃 처리되어야 합니다.

### 2.5 휴먼 회원

- 최근 로그인한 기록이 3달 이전이면 휴먼 상태가 됩니다.
- 휴먼 상태가되면 인증을 통해서 로그인할 수 있습니다.

## 3 주문

### 3.1 검색

- 메뉴명 + 설명을 기준으로 검색이 가능해야 합니다.
    - 검색 시 우선순위의 가중치를 적절히 정해주세요.
        - ex) 메뉴명에 가중치 * 100, 메뉴 설명에 가중치 * 10
    - 정렬기준 : 평점순
        - 사용자 평점을 기준으로 정렬합니다.
        - 최대 리뷰 n(건) 이상인 상점을 기준으로 정렬합니다.
            - 기준을 적절히 정해주세요.
                - ex) 100(건) 이상인 상점을 기준으로 정렬
                - ex) 10(건) 이상인 상점을 기준으로 정렬
    - 동의어, 유의어 검색이 돼야 합니다.
- 사용자는 지역이나 메뉴의 카테고리 등을 기준으로 원하는 상점을 검색할 수 있습니다.
    - 정렬 기준 : 거리순, 평점 순
- 상점 관리자에서 등록한 음식의 정보를 사용자에게 표시해야 합니다.
    - 추가로 배송 완료까지의 시간을 사용자에게 제공되어야 합니다.
        - 배송완료까지의 시간을 예측하는 방법에 대해서 적절한 규칙 정하기
        - ex) 25분 예상

### 3.2 메뉴선택

- 해당 상점의 메뉴 중 원하는 음식을 선택 후 주문 및 수량 조절이 가능해야 합니다.
- 주메뉴 선택 후 제공되는 보조메뉴를 선택할 수 있습니다.

### 3.3 장바구니

- 사용자는 주문할 메뉴를 장바구니에 담고, 필요에 따라 수량을 조절하거나 삭제할 수 있어야 합니다.
- 빈번하게 일어나는 장바구니 조회, 즉 성능을 고려하여 개발합니다.
- 메뉴 주문 시 보조 메뉴를 0개 이상 함께 선택할 수 있습니다.
- 장바구니는 영구적으로 유지되어야 합니다.

### 3.4 주문 확인 및 결제

- 직선거리 기준 3km 이상은 주문할 수 없습니다.
- 결제 금액에는 배달료가 포함됩니다.
    - 기본 배달료는 4,000원입니다.
- 사용자는 장바구니에 담은 메뉴를 주문하고 결제를 진행해야 합니다.
- 주문 시 요청 메모를 남길 수 있습니다.
    - ex) 도착 시 노크해 주세요
    - ex) 치킨 소스는 빼주세요.
- 결제 수단
    - 카드 결제
        - 토스페이먼트 : 다음 문서를 참고하여 개발환경에서 결제가 가능하도록 구현합니다.
            - https://docs.tosspayments.com/common/testing#%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0
    - 쿠폰은 중복해서 사용할 수 없습니다.
    - 포인트 전액 결제가 가능합니다.
        - 포인트 부분 결제 시 나머지 금액은 카드 결제로 진행합니다.
    - 포인트 적립은 판매가를 기준으로 정립됩니다.
    - 쿠폰 적용 순서
        - (판매가 - 쿠폰적용 - 포인트 )를 기준으로 쿠폰이 적용됩니다.
    - 포인트, 쿠폰 사용
        - 적립된 포인트를 사용해서 결제가 가능하도록 구현합니다.
        - ex) 치킨:20,000원, 포인트 5,000 사용 = 15,000원 카드결제
        - ex) 치킨:20,000원, 포인트 5,000 사용 = 생일 쿠폰(20,000 이상 최대 2,000원 할인) 사용, 20,000-5,000(포인트)-2000(생일 쿠폰) = 13,000원 카드결제
        - ex) 치킨: 20,000, 포인트 20,000 사용 = 포인트 결제완료
    - 확장성을 고려하여 개발합니다. ( 결제 수단으로 PAYCO가 추가된다면? )

## 4 주문, 리뷰

### 4.1 주문 상태 확인

- 사용자는 주문한 음식의 상태를 확인할 수 있어야 합니다.
- 준비 중, 배달 중, 완료 등의 상태를 사용자에게 제공되어야 합니다.
    - 주문상태는 Dooray메신저를 통해서 메시지가 전송됩니다.
    - 카카오톡, 텔레그램 메신저가 추가된다면…. 확장성을 고려해야 합니다.
- 배송완료까지의 소요 시간을 사용자에게 제공해야 합니다.
    - 해당 상점에서의 주문 대기시간 + 조리 시간 + 배송 시간 등을 고려하여 계산합니다.
    - 배송 예상 시간 계산 = GPS 좌표값을 참조하여 직선거리를 고려하여 시간을 계산합니다.

### 4.2 리뷰 및 평가

- 리뷰 작성
    - 사용자는 주문한 음식(요리)에 대한 리뷰를 작성할 수 있어야 합니다.
    - 평가 점수와 사진을 첨부하여 리뷰를 남길 수 있어야 합니다.
        - 평가 점수는 1~5점을 부여합니다.
    - 리뷰 작성 포인트가 적립됩니다.
        - 리뷰 : 200포인트 적립
        - 리뷰 + 사진 첨부 : 500포인트 적립
- 리뷰 및 평점 표시: 상점 관리자 페이지, 사용자 페이지에서 메뉴별로 사용자들의 리뷰와 평점이 표시되어야 합니다.
- 작성된 리뷰는 수정할 수 있지만 삭제할 수 없습니다.

## 5 포인트

- 포인트는 상점마다 기본 적립률을 설정할 수 있습니다.
- 포인트는 메뉴별로 적립률을 설정할 수 있습니다.
- 전체 메뉴에 대한 적립률과 개별 메뉴에 대한 적립률이 설정되어 있다면. 개별 메뉴에 대한 적립률이 우선하여 적용됩니다.
    - ex) 전체 적립률 : 5%, 치킨 적립률: 3%이면, 치킨 적립률 3% 적용됩니다.
- 회원가입: welcome 포인트 5,000 적립
- 리뷰 작성: 500포인트 적립
- 회원은 포인트 적립/사용 이력을 확인할 수 있습니다.

## 6 쿠폰

### 6.1 쿠폰 정책

- 쿠폰 정책
    - 할인
        - ex) 50,000 이상 구매 시 10,000 할인
        - ex) 20,000 이상 구매 시 3,000 할인
        - ex) 20,000 이상 구매 시 20% 할인, 최대 10,000원 할인
            - 30,000 구매 -> 6,000 할인
            - 100,000 구매 -> 10,000 할인

### 6.2 생일 쿠폰

- 사용자의 생일인 달에 매월 1일에 생일 쿠폰을 제공합니다.
    - ex) {5월 1일, 5월 5일, 5월 20일} 생일자 : 5월 1일에 쿠폰을 제공합니다.
    - 쿠폰사용기간 : 5월 1일 ~ 5월 31일(말 일)
- 생일쿠폰의 정책은 '쿠폰 정책'을 기준으로 생성합니다.
- 생일 쿠폰을 제공하는 과정에서 예외가 발생한다면 관리자가 확인할 수 있어야 합니다.

### 6.3 가맹점을 대상으로 하는 쿠폰

- 해당 가맹점을 대상으로 사용할 수 있는 쿠폰
- 해당 쿠폰은 사용기간이 정해져 있습니다.
    - 일 단위로 쿠폰을 발급받아 사용할 수 있습니다.
- ex) NHN 치킨 매일 3,000원 할인 쿠폰
    - NHN 치킨 모든 지점에서 사용할 수 있습니다.
- Application Main 화면에 배너 형태로 노출합니다.
    - 사용자는 해당 쿠폰을 발급받아 사용할 수 있습니다.
    - 발급받은 쿠폰은 쿠폰함에서 확인이 가능합니다.

## 7 배송시스템

- 배송 기사
    - 임의 배송 기사 n명 등록되어 있습니다.
- 배송 접수
    - 특정시간대에 과도하게 집중되는 배송요청을 고려하여 개발합니다.
- 배송 완료
    - 일정 시간이 지나면 자동으로 배송완료 됩니다.
- 배송 접수할 수 있는 REST-API가 제공되어야 합니다.
- 배송 상태를 조회할 수 있는 REST-API가 제공되어야 합니다.


# 개발환경

## 개발도구

- Intellij IDEA - Ultimate
    - https://www.jetbrains.com/ko-kr/idea/download
- 라이선스 만료되면 별도 문의하세요

## Language

- java 11
- Eclipse Temurin
    - https://adoptium.net/temurin/releases/?version=11

## 빌드도구

- Maven

## 개발

- Spring Framework
    - 5.x
- Spring Boot
    - 2.7.x
- JPA
    - QueryDSL

## 테스트 환경

- Junit5
    - https://junit.org/junit5/docs/current/user-guide/
- AssertJ
    - https://assertj.github.io/doc/
- Mokito
    - https://site.mockito.org/
- SonarQube
    - http://133.186.144.236:9000/
    - Test Coverage : 80% 이상

## 데이터베이스

- MySQL : 8.x
- Redis
    - https://nhnacademy.dooray.com/project/3452943795159056464/3520533059061338037

## 검색엔진

- Elastic Search : 7.x

## 모델링 (ERD)

- ERDCloud
    - https://www.erdcloud.com/
- [marco@nhnacademy.com](mailto:marco@nhnacademy.com) 관리자 맴버 초대하기

## 협업 도구

- GitHub Project
    - https://docs.github.com/ko/issues/planning-and-tracking-with-projects/learning-about-projects/quickstart-for-projects
- 브랜치 전략
    - Git Flow
        - https://nhnacademy.dooray.com/share/pages/iV0jBBZeTIy1tIC-m9gmRg/3375804732742205244

## CI/CD

- Continuous Integration
    - github
        - Contributor로 초대할 예정
- Continuous (Delivery, Deployment)
    - GitHub Action
        - https://docs.github.com/ko/actions
    - Jenkins
        - [http://133.186.144.236:8080](http://133.186.144.236:8080/)
    - Docker
        - NHN Container Registry (NCR)
            - https://docs.nhncloud.com/ko/Container/NCR/ko/overview/

## UI 개발

- BootStrap 사용
    - https://getbootstrap.com/
    - free template
        - https://tabler.io/
        - https://adminlte.io/
        - https://startbootstrap.com/theme/sb-admin-2
        - 기타 free template 사용가능

## NHN Cloud

- [Instance](https://docs.nhncloud.com/ko/Compute/Instance/ko/overview/)
    - 인스턴스는 가상의 CPU, 메모리, 기본 디스크로 구성된 가상 서버
- [Secure Key Manager](https://docs.nhncloud.com/ko/Security/Secure%20Key%20Manager/ko/overview/)
    - 기밀 데이터, 대칭키, 비대칭키 저장
- [Object Storage](https://docs.nhncloud.com/ko/Storage/Object%20Storage/ko/Overview/)
    - 다양한 유형의 데이터를 원하는 만큼 저장하고 필요할 때마다 가져올 수 있는 객체 스토리지 서비스
- [Image Manager](https://docs.nhncloud.com/ko/Contents%20Delivery/Image%20Manager/ko/Overview/)
    - 이미지의 저장, 편집 그리고 전송 기능까지 한번에 제공하는 서비스
- [Container Registry](https://docs.nhncloud.com/ko/Container/NCR/ko/overview/)
    - Docker 컨테이너 이미지를 쉽고 안전하게 저장, 관리하고 배포할 수 있는 컨테이너 레지스트리 서비스
- [Load Balancer](https://docs.nhncloud.com/ko/Network/Load%20Balancer/ko/overview/)
    - 로드 밸런서, 부하 분산
- [Log & Crash Search](https://docs.nhncloud.com/ko/Data%20&%20Analytics/Log%20&%20Crash%20Search/ko/Overview/)
    - 로그를 수집하여 원하는 로그를 검색하고 조회하는 시스템

## 기타

- 알림 관련된 메시지는 Dooray Hook Sender를 이용합니다.
    - https://nhnent.dooray.com/share/pages/zbJkAsWKRWiiLFiAxI7Jtw/3250156109508415493